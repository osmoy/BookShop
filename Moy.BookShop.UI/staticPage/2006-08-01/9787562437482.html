
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Visual Basic程序设计教程</title>
    <link href="/libs/css/global.css" rel="stylesheet" />
    <link href="/libs/css/channel.css" rel="stylesheet" />
    <link href="/libs/css/answer.css" rel="stylesheet" />
    <script src="/libs/js/jquery-1.8.2.min.js"></script>
    <script src="/libs/thired/ckeditor/ckeditor.js"></script>
</head>
<body>
    <div class="book_view">
        <h1 class="b_title">Visual Basic程序设计教程</h1>
        <div class="b_exa">
            <span class="book_group">Visual Basic程序设计教程</span>
            <span class="book_status">已经阅读（0 人） <span><a href="#">放入书架</a></span> <a href="#">什么是书架？</a></span>
        </div>

        <!--book basic start-->
        <dl class="put_book">
            <dt>
                <img src="/libs/Images/BookCovers/'9787562437482'.jpg" alt="Visual Basic程序设计教程" />
                <div class="chakan">
                    <img src="/libs/Images/zoom.gif" />
                    <a class="gray878787a" href="#">点击查看大图</a>
                </div>
            </dt>
            <dd>
                <div id="book_editor">
                    作　　者：  何国斌　主编<br />
                    出 版 社：  重庆大学出版社
                </div>
                <ul id="book_attribute">
                    <li>出版时间： 2006/8/1 0:00:00</li>
                    <li>字　　数： </li>
                    <li>版　　次： 1</li>

                    <li>页　　数： 540</li>
                    <li>印刷时间： 2009-5-1</li>
                    <li>开　　本： 16开</li>
                    <li>印　　次： 1</li>
                    <li>纸　　张： 胶版纸</li>
                    <li>I S B N    ： 9787562437482</li>

                    <li>包　　装： 平装</li>
                </ul>

                <div id="book_categroy">所属分类： <a href="#" target="_blank" class="blue12a">Basic VB VB Script</a></div>

                <div id="book_price">
                    <span class="red">定价：￥<b>30.0000</b></span>
                </div>

                <div id="book_point">
                    <br />
                    <a href="#">
                        <img src="/libs/Images/btn_goumai.gif" onmouseover="this.src='/libs/Images/btn_goumai_click.gif'" onmouseout="this.src='/libs/Images/btn_goumai.gif'" /></a>
                    <a href="#">
                        <img src="/libs/Images/btn_zancun.gif" onmouseover="this.src='/libs/Images/btn_zancun_click.gif'" onmouseout="this.src='/libs/Images/btn_zancun.gif'" /></a>
                </div>

                <div id="book_count">
                    顾客评分：<span id="book_id_15">0</span>
                    共有商品评论0条  <a href="#">查看评论摘要</a>
                </div>
            </dd>
        </dl>
        <!--book basic end-->
        <!--book intro start-->
        <dl class="book_intro">
            <dt>编辑推荐</dt>
            <dd>本书是根据教育部《关于进一步加强高等学校计算机基础教学的意见》(白皮书)，由重庆市普通高等院校计算机基础教育研究会组织编写。<br>　　本书以Visual Basic 6.0企业版为背景，以计算机程序设计的思想和方法为核心来组织教材内容。全书共分为12章，主要内容包括：Visual Basic概述、Visual Basic语言基础、窗体及控件、Visual Basic程序控制、数组与过程、综合界面设计、文件管理、图形程序设计、程序调试与错误处理、数据库编程技术、Internet及多媒体应用编程技术等。<br>　　本书的特点是内容涵盖“白皮书”及Visual Basic二级考试大纲，精选实例例程，注重理论性和实用性相结合；各章按照教学要求设计了一个或多个上机实验；各章都有明确的教学目的和要求，使课程的教与学更具目的性。<br>　　本书既可作为普通高等院校计算机基础教育教学用书及社会各种培训班的培训教材，也可作为参加Visual Basic二级等级考试的参考用书。</dd>
        </dl>
        <div id="showRemain">
            <dl class="book_intro">
                <dt>目录</dt>
                <dd style="display: block">1　Visual Basic概述<br>　1.1　面向对象程序设计<br>　　1.1.1　面向过程与面向对象程序设计<br>　　1.1.2　对象与类的概念<br>　　1.1.3　事件驱动机制<br>　1.2　Visual Basic简介<br>　　1.2.1　VB的发展历史及特点<br>　　1.2.2　VB 6.0的安装与运行<br>　1.3　VB 6.0集成开发环境<br>　　1.3.1　VB 6.0集成开发环境<br>　　1.3.2　VB 6.0的3种模式<br>　　1.3.3　VB 6.0的菜单系统<br>　　1.3.4　工具栏与工具箱<br>　　1.3.5　窗口简介<br>　1.4　VB 6.0控件的操作<br>　　1.4.1　控件对象的建立<br>　　1.4.2　控件的属性设置<br>　1.5　VB创建应用程序的基本步骤<br>　　1.5.1　VB 6.0代码的书写规范<br>　　1.5.2　创建应用程序的基本步骤<br>　1.6　VB 6.0工程管理<br>　　1.6.1　VB应用程序的组织<br>　　1.6.2　工程管理<br>　小结1<br>　习题1<br>　实验1　VB应用程序建立的基本步骤<br>2　VB 6.0语言基础<br>　2.1　数据类型<br>　2.2　常量与变量<br>　　2.2.1　常量<br>　　2.2.2　变量<br>　　2.2.3　变量的作用域<br>　2.3　运算符与表达式<br>　　2.3.1　算术运算符与算术表达式<br>　　2.3.2　关系运算符与关系表达式<br>　　2.3.3　逻辑运算符与逻辑表达式<br>　　2.3.4　字符连接运算符<br>　2.4　常用内部函数<br>　　2.4.1　数学函数<br>　　2.4.2　字符串函数<br>　　2.4.3　转换函数<br>　　2.4.4　日期函数<br>　　2.4.5　其他函数<br>　小结2<br>　习题2<br>　实验2　VB6.0常用函数的使用<br>3　常用控件<br>　3.1　窗体设计<br>　　3.1.1　窗体设计的基本方法<br>　　3.1.2　窗体的属性<br>　　3.1.3　窗体事件<br>　　3.1.4　窗体的方法<br>　　3.1.5　多重窗体<br>　3.2　VB标准控件及使用<br>　　3.2.1　标签控件<br>　　3.2.2　文本框控件<br>　　3.2.3　命令按钮控件<br>　　3.2.4　单选按钮与复选框控件<br>　　3.2.5　框架控件<br>　　3.2.6　图片框与图像框控件<br>　　3.2.7　计时器控件<br>　　3.2.8　滚动条控件<br>　　3.2.9　列表框与组合框控件<br>　小结3<br>　习题3<br>　实验3　常用控件编程实验<br>4　VB程序控制<br>　4.1　结构化程序设计概述<br>　　4.1.1　算法的概念<br>　　4.1.2　程序的控制结构<br>　4.2　顺序结构程序设计<br>　　4.2.1　赋值语句<br>　　4.2.2　输入输出函数<br>　　4.2.3　Print方法<br>　　4.2.4　文本框与标签控件用于数据的输入和输出<br>　　4.2.5　常用的基本语句<br>　4.3　选择结构程序设计<br>　　4.3.1　If语句<br>　　4.3.2　If语句的嵌套<br>　　4.3.3　多路分支结构<br>　　4.3.4　情况测试Select Case语句<br>　　4.3.5　Iif函数与Choose函数<br>　4.4　循环结构程序设计<br>　　4.4.1　利用IF语句与Goto语句构成循环<br>　　4.4.2　While…Wend循环语句<br>　　4.4.3　Do…Loop循环语句<br>　　4.4.4　For…Next循环语句<br>　　4.4.5　循环结构的嵌套<br>　4.5　综合应用举例<br>　小结4<br>　习题4<br>　实验4　程序控制结构实验（1）<br>　实验5　程序控制结构实验（2）<br>5　数组<br>　5.1　数组的概念<br>　　5.1.1　数组与数组元素<br>　　5.1.2　数组的下标与维数<br>　5.2　数组的声明与使用<br>　　5.2.1　固定数组<br>　　5.2.2　动态数组<br>　5.3　数组的应用<br>　5.4　控件数组<br>　　5.4.1　控件数组的概念<br>　　5.4.2　控件数组的建立<br>　　5.4.3　控件数组的使用<br>　小结5<br>　习题5<br>　实验6　一维数组的使用<br>　实验7　二维数组的使用<br>6　过程<br>　6.1　键盘与鼠标事件过程<br>　　6.1.1　键盘事件过程<br>　　6.1.2　鼠标事件过程<br>　6.2　VB通用过程<br>　　6.2.1　VB通用过程概述<br>　　6.2.2　Sub过程<br>　　6.2.3　Function过程<br>　　6.2.4　过程调用及参数的传递<br>　　6.2.5　递归<br>　6.3　常用计算方法<br>　小结6<br>　习题6<br>　实验8　Sub过程的编写与调用<br>　实验9　Function过程的编写与调用<br>7　界面设计<br>　7.1　用户界面设计基础<br>　7.2　对话框设计<br>　　7.2.1　通用对话框<br>　　7.2.2　自定义对话框<br>　7.3　菜单设计<br>　　7.3.1　菜单的基本类型<br>　　7.3.2　菜单编辑器<br>　　7.3.3　创建下拉式菜单<br>　　7.3.4　编写菜单事件过程代码<br>　　7.3.5　快捷菜单设计<br>　7.4　工具栏设计和状态栏设计<br>　　7.4.1　工具栏设计<br>　　7.4.2　状态栏设计<br>　7.5　多文档（MDI）窗体的设计<br>　　7.5.1　创建MDI界面<br>　　7.5.2　MDI窗体应用实例<br>　小结7<br>　习题7<br>　实验10　界面设计实验<br>8　文件管理<br>　8.1　文件管理基础知识<br>　　8.1.1　文件与文件类型<br>　　8.1.2　文件访问的基本方法<br>　8.2　文件系统控件<br>　　8.2.1　驱动器列表框<br>　　8.2.2　目录列表框<br>　　8.2.3　文件列表框<br>　　8.2.4　文件系统控件的使用<br>　8.3　文件I/O语句对文件的访问<br>　　8.3.1　文件操作命令及函数<br>　　8.3.2　顺序文件的访问<br>　　8.3.3　随机文件的访问<br>　　8.3.4　二进制文件的访问<br>　8.4　FSO对象模型<br>　　8.4.1　FileSystemObject对象<br>　　8.4.2　文件夹操作<br>　　8.4.3　文件操作<br>　小结8<br>　习题8<br>　实验11　文件管理实验<br>9　图形程序设计<br>　9.1　坐标系统<br>　　9.1.1　标准坐标系<br>　　9.1.2　自定义坐标系<br>　9.2　绘图属性<br>　　9.2.1　基本属性<br>　　9.2.2　线宽与线型<br>　　9.2.3　色彩与填充<br>　9.3　图形控件<br>　　9.3.1　图片框控件与图像框控件<br>　　9.3.2　直线控件与形状控件<br>　9.4　绘图方法<br>　　9.4.1　Cls方法<br>　　9.4.2　Line方法<br>　　9.4.3　Circle方法<br>　　9.4.4　Pset方法<br>　　9.4.5　Point方法<br>　　9.4.6　PaintPicture方法<br>　　9.4.7　SavePicture方法<br>　小结9<br>　习题9<br>　实验12　图形程序设计实验<br>10　程序调试与错误处理<br>　10.1　VB程序错误的类型<br>　10.2　程序调试<br>　　10.2.1　VB的中断模式<br>　　10.2.2　调试窗口<br>　　10.2.3　中断调试<br>　　10.2.4　单步调试<br>　　10.2.5　跳跃调试<br>　10.3　错误处理<br>　　10.3.1　错误陷阱<br>　　10.3.2　错误处理<br>　小结10<br>　习题10<br>　实验13　程序调试步骤实验<br>11　数据库编程技术<br>　11.1　数据库基础知识<br>　　11.1.1　数据库的产生与发展<br>　　11.1.2　关系数据库的基本概念<br>　　11.1.3　VB数据库系统<br>　11.2　数据库的建立及基本操作<br>　　11.2.1　建立数据库<br>　　11.2.2　数据表的基本操作<br>　11.3　数据控件和数据绑定控件<br>　　11.3.1　Data控件<br>　　11.3.2　数据绑定控件<br>　　11.3.3　Recordset对象<br>　11.4　ADO控件编程<br>　　11.4.1　ADO对象模型<br>　　11.4.2　ADO数据控件<br>　　11.4.3　使用ADO数据控件访问数据库<br>　11.5　使用SQL操作数据库<br>　　11.5.1　SQL概述<br>　　11.5.2　SQL在VB中的应用<br>　小结11<br>　习题11<br>　实验14　数据库访问实验<br>12　Internet与多媒体应用程序设计<br>　12.1　Internet应用程序设计<br>　　12.1.1　VB环境下Internet编程基础<br>　　12.1.2　Web浏览器应用程序设计<br>　　12.1.3　Internet Transfer控件<br>　　12.1.4　Email程序设计<br>　　12.1.5　利用ActiveX文档生成自制网页<br>　12.2　多媒体编程<br>　　12.2.1　多媒体程序设计基础<br>　　12.2.2　利用Animation控件播放无声动画<br>　　12.2.3　使用Multimedia控件（MCl）编写多媒体程序<br>　　12.2.4　Windows Media Player控件的使用<br>　　12.2.5　利用API函数编写多媒体应用程序<br>　小结12<br>　习题12<br>　实验15　多媒体程序设计实验<br>附录<br>　附录A：ASCⅡ码表（基本集）<br>　附录B：VB 6.0常用语句一览表<br>参考文献</dd>
                <span style="display: none;">1　Visual Basic概述<br>　1.1　面向对象程序设计<br>　　1.1.1　面向过程与面向对象程序设计<br>　　1.1.2　对象与类的概念<br>　　1.1.3　事件驱动机制<br>　1.2　Visual Basic简介<br>　　1.2.1　VB的发展历史及特点<br>　　1.2.2　VB 6.0的安装与运行<br>　1.3　VB 6.0集成开发环境<br>　　1.3.1　VB 6.0集成开发环境<br>　　1.3.2　VB 6.0的3种模式<br>　　1.3.3　VB 6.0的菜单系统<br>　　1.3.4　工具栏与工具箱<br>　　1.3.5　窗口简介<br>　1.4　VB 6.0控件的操作<br>　　1.4.1　控件对象的建立<br>　　1.4.2　控件的属性设置<br>　1.5　VB创建应用程序的基本步骤<br>　　1.5.1　VB 6.0代码的书写规范<br>　　1.5.2　创建应用程序的基本步骤<br>　1.6　VB 6.0工程管理<br>　　1.6.1　VB应用程序的组织<br>　　1.6.2　工程管理<br>　小结1<br>　习题1<br>　实验1　VB应用程序建立的基本步骤<br>2　VB 6.0语言基础<br>　2.1　数据类型<br>　2.2　常量与变量<br>　　2.2.1　常量<br>　　2.2.2　变量<br>　　2.2.3　变量的作用域<br>　2.3　运算符与表达式<br>　　2.3.1　算术运算符与算术表达式<br>　　2.3.2　关系运算符与关系表达式<br>　　2.3.3　逻辑运算符与逻辑表达式<br>　　2.3.4　字符连接运算符<br>　2.4　常用内部函数<br>　　2.4.1　数学函数<br>　　2.4.2　字符串函数<br>　　2.4.3　转换函数<br>　　2.4.4　日期函数<br>　　2.4.5　其他函数<br>　小结2<br>　习题2<br>　实验2　VB6.0常用函数的使用<br>3　常用控件<br>　3.1　窗体设计<br>　　3.1.1　窗体设计的基本方法<br>　　3.1.2　窗体的属性<br>　　3.1.3　窗体事件<br>　　3.1.4　窗体的方法<br>　　3.1.5　多重窗体<br>　3.2　VB标准控件及使用<br>　　3.2.1　标签控件<br>　　3.2.2　文本框控件<br>　　3.2.3　命令按钮控件<br>　　3.2.4　单选按钮与复选框控件<br>　　3.2.5　框架控件<br>　　3.2.6　图片框与图像框控件<br>　　3.2.7　计时器控件<br>　　3.2.8　滚动条控件<br>　　3.2.9　列表框与组合框控件<br>　小结3<br>　习题3<br>　实验3　常用控件编程实验<br>4　VB程序控制<br>　4.1　结构化程序设计概述<br>　　4.1.1　算法的概念<br>　　4.1.2　程序的控制结构<br>　4.2　顺序结构程序设计<br>　　4.2.1　赋值语句<br>　　4.2.2　输入输出函数<br>　　4.2.3　Print方法<br>　　4.2.4　文本框与标签控件用于数据的输入和输出<br>　　4.2.5　常用的基本语句<br>　4.3　选择结构程序设计<br>　　4.3.1　If语句<br>　　4.3.2　If语句的嵌套<br>　　4.3.3　多路分支结构<br>　　4.3.4　情况测试Select Case语句<br>　　4.3.5　Iif函数与Choose函数<br>　4.4　循环结构程序设计<br>　　4.4.1　利用IF语句与Goto语句构成循环<br>　　4.4.2　While…Wend循环语句<br>　　4.4.3　Do…Loop循环语句<br>　　4.4.4　For…Next循环语句<br>　　4.4.5　循环结构的嵌套<br>　4.5　综合应用举例<br>　小结4<br>　习题4<br>　实验4　程序控制结构实验（1）<br>　实验5　程序控制结构实验（2）<br>5　数组<br>　5.1　数组的概念<br>　　5.1.1　数组与数组元素<br>　　5.1.2　数组的下标与维数<br>　5.2　数组的声明与使用<br>　　5.2.1　固定数组<br>　　5.2.2　动态数组<br>　5.3　数组的应用<br>　5.4　控件数组<br>　　5.4.1　控件数组的概念<br>　　5.4.2　控件数组的建立<br>　　5.4.3　控件数组的使用<br>　小结5<br>　习题5<br>　实验6　一维数组的使用<br>　实验7　二维数组的使用<br>6　过程<br>　6.1　键盘与鼠标事件过程<br>　　6.1.1　键盘事件过程<br>　　6.1.2　鼠标事件过程<br>　6.2　VB通用过程<br>　　6.2.1　VB通用过程概述<br>　　6.2.2　Sub过程<br>　　6.2.3　Function过程<br>　　6.2.4　过程调用及参数的传递<br>　　6.2.5　递归<br>　6.3　常用计算方法<br>　小结6<br>　习题6<br>　实验8　Sub过程的编写与调用<br>　实验9　Function过程的编写与调用<br>7　界面设计<br>　7.1　用户界面设计基础<br>　7.2　对话框设计<br>　　7.2.1　通用对话框<br>　　7.2.2　自定义对话框<br>　7.3　菜单设计<br>　　7.3.1　菜单的基本类型<br>　　7.3.2　菜单编辑器<br>　　7.3.3　创建下拉式菜单<br>　　7.3.4　编写菜单事件过程代码<br>　　7.3.5　快捷菜单设计<br>　7.4　工具栏设计和状态栏设计<br>　　7.4.1　工具栏设计<br>　　7.4.2　状态栏设计<br>　7.5　多文档（MDI）窗体的设计<br>　　7.5.1　创建MDI界面<br>　　7.5.2　MDI窗体应用实例<br>　小结7<br>　习题7<br>　实验10　界面设计实验<br>8　文件管理<br>　8.1　文件管理基础知识<br>　　8.1.1　文件与文件类型<br>　　8.1.2　文件访问的基本方法<br>　8.2　文件系统控件<br>　　8.2.1　驱动器列表框<br>　　8.2.2　目录列表框<br>　　8.2.3　文件列表框<br>　　8.2.4　文件系统控件的使用<br>　8.3　文件I/O语句对文件的访问<br>　　8.3.1　文件操作命令及函数<br>　　8.3.2　顺序文件的访问<br>　　8.3.3　随机文件的访问<br>　　8.3.4　二进制文件的访问<br>　8.4　FSO对象模型<br>　　8.4.1　FileSystemObject对象<br>　　8.4.2　文件夹操作<br>　　8.4.3　文件操作<br>　小结8<br>　习题8<br>　实验11　文件管理实验<br>9　图形程序设计<br>　9.1　坐标系统<br>　　9.1.1　标准坐标系<br>　　9.1.2　自定义坐标系<br>　9.2　绘图属性<br>　　9.2.1　基本属性<br>　　9.2.2　线宽与线型<br>　　9.2.3　色彩与填充<br>　9.3　图形控件<br>　　9.3.1　图片框控件与图像框控件<br>　　9.3.2　直线控件与形状控件<br>　9.4　绘图方法<br>　　9.4.1　Cls方法<br>　　9.4.2　Line方法<br>　　9.4.3　Circle方法<br>　　9.4.4　Pset方法<br>　　9.4.5　Point方法<br>　　9.4.6　PaintPicture方法<br>　　9.4.7　SavePicture方法<br>　小结9<br>　习题9<br>　实验12　图形程序设计实验<br>10　程序调试与错误处理<br>　10.1　VB程序错误的类型<br>　10.2　程序调试<br>　　10.2.1　VB的中断模式<br>　　10.2.2　调试窗口<br>　　10.2.3　中断调试<br>　　10.2.4　单步调试<br>　　10.2.5　跳跃调试<br>　10.3　错误处理<br>　　10.3.1　错误陷阱<br>　　10.3.2　错误处理<br>　小结10<br>　习题10<br>　实验13　程序调试步骤实验<br>11　数据库编程技术<br>　11.1　数据库基础知识<br>　　11.1.1　数据库的产生与发展<br>　　11.1.2　关系数据库的基本概念<br>　　11.1.3　VB数据库系统<br>　11.2　数据库的建立及基本操作<br>　　11.2.1　建立数据库<br>　　11.2.2　数据表的基本操作<br>　11.3　数据控件和数据绑定控件<br>　　11.3.1　Data控件<br>　　11.3.2　数据绑定控件<br>　　11.3.3　Recordset对象<br>　11.4　ADO控件编程<br>　　11.4.1　ADO对象模型<br>　　11.4.2　ADO数据控件<br>　　11.4.3　使用ADO数据控件访问数据库<br>　11.5　使用SQL操作数据库<br>　　11.5.1　SQL概述<br>　　11.5.2　SQL在VB中的应用<br>　小结11<br>　习题11<br>　实验14　数据库访问实验<br>12　Internet与多媒体应用程序设计<br>　12.1　Internet应用程序设计<br>　　12.1.1　VB环境下Internet编程基础<br>　　12.1.2　Web浏览器应用程序设计<br>　　12.1.3　Internet Transfer控件<br>　　12.1.4　Email程序设计<br>　　12.1.5　利用ActiveX文档生成自制网页<br>　12.2　多媒体编程<br>　　12.2.1　多媒体程序设计基础<br>　　12.2.2　利用Animation控件播放无声动画<br>　　12.2.3　使用Multimedia控件（MCl）编写多媒体程序<br>　　12.2.4　Windows Media Player控件的使用<br>　　12.2.5　利用API函数编写多媒体应用程序<br>　小结12<br>　习题12<br>　实验15　多媒体程序设计实验<br>附录<br>　附录A：ASCⅡ码表（基本集）<br>　附录B：VB 6.0常用语句一览表<br>参考文献</span>
                <a href="javascript:;">查看完整目录</a>
            </dl>
        </div>
        <!--book intro end-->

        <!--recommed start-->
        <div class="comm_answer">
            <!--review head start-->
            <div id="div_product_reviews">
                <div class="total_comm">
                    <div class="comm_title">
                        <h2>商品评论 共<em>814</em>条
                        <span class="look_comm">(<a href="#" name='reviewList' target='_blank'>查看所有评论</a>)</span></h2>
                    </div>

                    <div class="total_body">
                        <div class="people_average">
                            <div class="average_left">
                                <p>购买过的顾客平均评分</p>
                                <span class="a_red28b pd">4</span><span class="red_bold">星半</span><img src='/libs/Images/star_red.gif' /><img src='/libs/Images/star_red.gif' /><img src='/libs/Images/star_red.gif' /><img src='/libs/Images/star_red.gif' /><img src='/libs/Images/star_redgray_big.gif' />
                            </div>
                            <span class="span_jt" id="div_window_star">
                                <input class="button_down1" value="" type="button" />
                            </span>
                        </div>

                        <div id="div_product_summary">
                            <div class="people_heart">
                                心情指数:<em>249</em>人 开心
                                <span id="div_emotion_hover">
                                    <input class="button_down1" type="button" />
                                </span>
                            </div>
                            <div id="Div1" class="people_read">
                                阅读场所:<em>180</em>人 床上
                                <span id="div_location_hover">
                                    <input class="button_down1" type="button" />
                                </span>
                            </div>
                        </div>

                        <div class="write_comm">
                            <a id="reviewTipa" href="#">
                                <img src="/libs/Images/button_write_comm.gif" border="0" title="写评论" />
                            </a>
                        </div>

                    </div>
                </div>
            </div>
            <!--review head end-->

            <!--the one reviews start-->
            <div class="comm_list">
                <ul id="ul1">
                    <!--<h3>
                        <img src="/libs/Images/label_1.gif" title="精彩评论" /><a href="#" target="_blank"></a>
                        <span>发表于 2009-04-29 22:46</span>
                    </h3>             -->
                </ul>
            </div>
            <!--the one reviews end-->

            <div style="position: relative; right: 664px; bottom: 330px;">
                <div id="div2" style="clear: both;">
                    标题：<input style="width: 200px;" type="text" name="title" value="" /><br />
                    <textarea cols="40" rows="20" id="txtMsg" name="txtMsg"></textarea><br />
                    <input type="button" name="save" value="发表评论" />
                </div>
                <a href="/book/ShoppingCart.aspx?bid=6069">
                    <img style="margin-top: 4px;" src="/libs/Images/sale.gif" alt="添加到购物车" /></a>
            </div>
        </div>
        <!--recommed end-->
    </div>

    <script type="text/javascript">
        var book_score = parseInt($("book_id_15").innerHTML);
        var book_score_str = "";

        for (var m = 0; m < book_score; m++) {
            book_score_str += "<img src='images/star_red.gif' />";
        }
        $("book_id_15").innerHTML = book_score_str;

        showContent();

        function showContent() {
            var oDiv = document.getElementById('showRemain');
            var oA = oDiv.getElementsByTagName('a')[0];
            var oSpan = oDiv.getElementsByTagName('span')[0];
            var odd = oDiv.getElementsByTagName('dd')[0];
            var oBtn = true;
            oA.onclick = function () {
                if (oBtn) {
                    odd.style.display = 'none';
                    oSpan.style.display = 'block';
                    oA.innerHTML = '查看部分目录';
                    oBtn = false;
                } else {
                    oBtn = true;
                    odd.style.display = 'block';
                    oSpan.style.display = 'none';
                    oA.innerHTML = '查看完整目录';
                }
            }
        }

    </script>

    <script type="text/javascript">
        jQuery(function () {
            LoadUBB();
            LoadComment();
        });

        jQuery('#div2 input[type=button]').click(function () {
            var title = $('#div2 input[type=text]').val();
            //var msg = $('#txtMsg').val();
            var oEditor = CKEDITOR.instances.txtMsg;
            var msg = oEditor.getData();
            if (msg == '') {
                alert('评论内容不能为空');
            }else if(msg.length<=6){
                alert('评论内容不能少于6个字符');
            } else if (msg.length >= 50) {
                alert('评论内容不能超过50个字符');
            } else {
                var data = {
                    Action: 'add',
                    Title: title,
                    Msg: msg,
                    bookId: 6069
                }
                $.post('/ashx/ProcessComment.ashx', { data: data }, function (resData) {
                    if (resData == 'ok') {
                        alert('添加评论成功');
                        var ul = $('#ul1');

                        if (ul.first()) {
                            $('<li><h3><img src="/libs/Images/label_1.gif" title="精彩评论" /><a href="#" target="_blank">'+title+'</a><span>发表于刚刚</span></h3>'+msg+'</li>').insertBefore(ul.first());
                        } else {
                            $('<li><h3><img src="/libs/Images/label_1.gif" title="精彩评论" /><a href="#" target="_blank">'+title+'</a><span>发表于刚刚</span></h3>'+msg+'</li>').appendTo(ul);
                        }
                        $('#div2 input[type=text]').val('');                    
                        oEditor.setData('');
                    } else if (resData == 'forbid') {
                        alert('包含非法字符，请正确发表评论');
                    } else {
                        alert('添加评论失败');
                    }
                })
            }         
        })

        function LoadComment() {
            var data = {
                Action: 'load',
                bookId: 6069
            }

            $.post('/ashx/ProcessComment.ashx', { data: data },function (Data) {
                if(Data!=null){
                    var json = JSON.parse(Data);
                    var ul = $('#ul1');
                    for (var i = 0; i < json.length; i++) {
                        $('<li><h3><img src="/libs/Images/label_1.gif" title="精彩评论" /><a href="#" target="_blank">'+json[i].Title+'</a><span>发表于'+json[i].Date+'</span></h3>'+json[i].Content+'</li>').appendTo(ul);
                    }
                }
            })
        }

        function LoadUBB() {
            CKEDITOR.replace( 'txtMsg',
                {
                    extraPlugins : 'bbcode',
                    removePlugins : 'bidi,button,dialogadvtab,div,filebrowser,flash,format,forms,horizontalrule,iframe,indent,justify,liststyle,pagebreak,showborders,stylescombo,table,tabletools,templates',
                    toolbar :
                    [
                        ['Source', '-', 'Save','NewPage','-','Undo','Redo'],
                        ['Find','Replace','-','SelectAll','RemoveFormat'],
                        ['Link', 'Unlink', 'Image'],
                        '/',
                        ['FontSize', 'Bold', 'Italic','Underline'],
                        ['NumberedList','BulletedList','-','Blockquote'],
                        ['TextColor', '-', 'Smiley','SpecialChar', '-', 'Maximize']
                    ],
                    smiley_images :
                    [
                        'regular_smile.gif','sad_smile.gif','wink_smile.gif','teeth_smile.gif','tounge_smile.gif',
                        'embaressed_smile.gif','omg_smile.gif','whatchutalkingabout_smile.gif','angel_smile.gif','shades_smile.gif',
                        'cry_smile.gif','kiss.gif'
                    ],
                    smiley_descriptions :
                    [
                        'smiley', 'sad', 'wink', 'laugh', 'cheeky', 'blush', 'surprise',
                        'indecision', 'angel', 'cool', 'crying', 'kiss'
                    ]
                });
        }
    </script>

</body>
</html>